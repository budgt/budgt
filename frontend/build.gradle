group = 'de.budgt'
version = '0.0.1-SNAPSHOT'

task clean {
	description 'Clean workspace'
    doLast {
        exec {
            workingDir './'
            commandLine 'sh', '-c', 'if [ ! -d dist ]; then rm -rf dist; fi'

        }
    }
}

task build {
	description 'Build angular app'
    doLast {
        exec {
            workingDir './'
            commandLine 'sh', '-c', 'ng build --configuration=production'

        }
    }
}

task buildLocal{
	description 'Build angular app'
    doLast {
        exec {
            workingDir './'
            commandLine 'sh', '-c', 'ng build'

        }
    }
}

task dockerbuild {
	description 'Build frontend docker image.'
    doLast {
        exec {
            workingDir './'
            commandLine 'sh', '-c', 'docker build -f build/deploy/docker/frontend/Dockerfile -t budgt-frontend .'

        }
    }
}

task cleanBuildDockerLocal {
    dependsOn 'clean'
    dependsOn 'buildLocal'
    dependsOn 'dockerbuild'
    tasks.findByName('buildLocal').mustRunAfter 'clean'
    tasks.findByName('dockerbuild').mustRunAfter 'buildLocal'
}

